<!-- Adapted from:
- https://threejs.org/examples/?q=parametri#webgl_geometries_parametric
- https://threejs.org/examples/?q=sha#webgl_geometry_extrude_shapes2
 -->

<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Loss Landscapes of Regularized Linear Autoencoders</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	</head>
	<style type="text/css">
		body {
			margin: 0px;
			padding: 0px;
			overflow: hidden;
			font-family: Lucida Grande;
			font-size: 11px;
		}
		#info {
			position: absolute;
			top: 0px; width: 300px;
			margin-left: 15px;
			background-color: black;
			color: white;
			background-color: black;
			color: white;
		}
		#content {
			border-bottom: 1px solid rgba(255,255,255,0.2);
			background-color: #1A1A1A;
		}
		.controls {
			margin: 3.5px auto;
			text-align: center;
			cursor: pointer;
		}
		p, h3 {
			margin: 10px;
		}
		a {
			color: white;
		}
		#container {
			cursor: move;
		}

	</style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>
	<body>

		<div id="container"></div>
		<div id="info">
			<div id="content" style="display: none">
				<p>Explore the following loss landscapes where <script>document.write(katex.renderToString('w_1,w_2,x,y \\in \\mathbb{R}'));</script>.</p>
				<h3>(1) Linear Autoencoder (scalar case):</h3>
				<script>
	                var render = katex.renderToString("\\begin{aligned} \\text{Unregularized: } & (x - w_2w_1x)^2 \\cr  \\text{Product: } & (x - w_2w_1x)^2 + \\lambda|w_2 w_1|^\\alpha \\cr \\text{Sum: } & (x - w_2w_1x)^2 + \\lambda \\left( |w_2|^\\alpha + |w_1|^\\alpha \\right )  \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script>
	            <h3>(2) Linear Autoencoder (vector case):</h3>
				<script>
	                var render = katex.renderToString("\\begin{aligned} \\text{Unregularized: } & ||X - WW^\\intercal X||^2_F \\cr  \\text{Product: } & ||X - WW^\\intercal X||^2_F + \\lambda||W W^\\intercal||^\\alpha_F \\cr \\text{Sum: } & ||X - WW^\\intercal X||^2_F + 2\\lambda ||W||^\\alpha_F \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script>
	            <p>where <script>document.write(katex.renderToString('W, X'));</script> are defined as</p>
	            <script>
	                var render = katex.renderToString("W = \\begin{bmatrix} w_1 \\cr w_2 \\end{bmatrix}\\qquad X = \\begin{bmatrix} x & 0 \\cr 0 & y \\end{bmatrix} ", { displayMode: true });
	                document.writeln(render);
	            </script>
	            <h3>(3) Low-rank Prediction:</h3>
	            <script>
	                var render = katex.renderToString("\\begin{aligned} \\text{Unregularized: } & (y - w_2w_1x)^2 \\cr  \\text{Product: } & (y - w_2w_1x)^2 + \\lambda|w_2 w_1|^\\alpha \\cr \\text{Sum: } & (y - w_2w_1x)^2 + \\lambda \\left( |w_2|^\\alpha + |w_1|^\\alpha \\right )  \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script>
	            <h3>(4) Weight Alignment:</h3>
	            <script>
	                var render = katex.renderToString("\\begin{aligned} \\mathcal{L}_{\\text{pred}} &= (y - w_2w_1x)^2 \\cr  \\mathcal{L}_{\\text{info}} &= (x - w_2w_1x)^2 \\cr \\mathcal{L}_{\\text{reg}} &= w_2^2 + w_1^2 \\cr \\mathcal{L}_{\\text{self}} &= -2 w_2w_1  \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script>
	            <p>Weighted by their respective <script>document.write(katex.renderToString('\\lambda\'s'));</script>, these terms are combined to construct various loss landscapes.</p>
	            <script>
	                var render = katex.renderToString("\\begin{aligned} \\text{Backpropagation: } & \\mathcal{L}_{\\text{pred}} \\;(+ \\; \\mathcal{L}_{\\text{reg}}) \\cr  \\text{Information Alignment: } & \\mathcal{L}_{\\text{pred}} + \\mathcal{L}_{\\text{info}} + \\mathcal{L}_{\\text{reg}}\\cr \\text{Symmetric Alignment: } & \\mathcal{L}_{\\text{pred}} + \\mathcal{L}_{\\text{self}} + \\mathcal{L}_{\\text{reg}} \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script>

				<!-- <p>This is an interactive visualization of the loss landscapes described in <a href="https://github.com/danielkunin/Regularized-Linear-Autoencoders">Loss Landscapes of Regularized Linear Autoencoders</a>.</p>
				<p>In the scalar case <script>document.write(katex.renderToString('w_1,w_2,x \\in \\mathbb{R}'));</script> and the loss functions are:</p>
				<script>
	                var render = katex.renderToString("\\begin{aligned} \\text{Unregularized: } & (x - w_2w_1x)^2 \\cr  \\text{Product: } & (x - w_2w_1x)^2 + \\lambda|w_2 w_1|^\\alpha \\cr \\text{Sum: } & (x - w_2w_1x)^2 + \\lambda \\left( |w_2|^\\alpha + |w_1|^\\alpha \\right )  \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script>
            	<p>In the vector case <script>document.write(katex.renderToString('W, X \\in \\mathbb{R}^2'));</script> are defined as</p>
	            <script>
	                var render = katex.renderToString("W = \\begin{bmatrix} w_1 \\cr w_2 \\end{bmatrix}\\qquad X = \\begin{bmatrix} x_1 \\cr x_2 \\end{bmatrix} ", { displayMode: true });
	                document.writeln(render);
	            </script>
	            <p>and the loss functions are:</p>
	            <script>
	                var render = katex.renderToString("\\begin{aligned} \\text{Unregularized: } & ||X - WW^\\intercal X||^2_F \\cr  \\text{Product: } & ||X - WW^\\intercal X||^2_F + \\lambda|WW^\\intercal|^\\alpha\\cr \\text{Sum: } & ||X - WW^\\intercal X||^2_F + 2\\lambda |W|^\\alpha  \\end{aligned}", { displayMode: true });
	                document.writeln(render);
	            </script> -->
            </div>
            <div class="controls" id="open">
				Open Explanation
			</div>
			<div class="controls" id="close" style="display: none">
				Close Explanation
			</div>
		</div>
		<script src="js/three/three.js"></script>
		<script src="js/three/Detector.js"></script>
		<script src="js/three/controls/OrbitControls.js"></script>
		<script src="js/text.js"></script>
		<script src="js/dat.gui.min.js"></script>
		<script src="js/landscape.js"></script>
		<script type="text/javascript">
			document.getElementById("open").addEventListener("click", function(){
				document.getElementById("content").style.display = "block";
				document.getElementById("open").style.display = "none";
				document.getElementById("close").style.display = "block";
			});
			document.getElementById("close").addEventListener("click", function(){
				document.getElementById("content").style.display = "none";
				document.getElementById("open").style.display = "block";
				document.getElementById("close").style.display = "none";
			});
		</script>
	</body>
</html>

